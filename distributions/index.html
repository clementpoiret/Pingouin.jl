<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Distributions · Pingouin</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Pingouin</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Pingouin.jl Documentation</a></li><li><a class="tocitem" href="../datasets/">Datasets</a></li><li class="is-active"><a class="tocitem" href>Distributions</a></li><li><a class="tocitem" href="../effsize/">Effect Sizes</a></li><li><a class="tocitem" href="../bayesian/">Bayesian</a></li><li><a class="tocitem" href="../nonparametric/">Non-Parametric Tests</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Distributions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Distributions</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/clementpoiret/Pingouin.jl/blob/master/docs/src/distributions.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Distributions"><a class="docs-heading-anchor" href="#Distributions">Distributions</a><a id="Distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Distributions" title="Permalink"></a></h1><p>Statistical tests for multiple distributions, and tests for homoscedasticity.</p><article class="docstring"><header><a class="docstring-binding" id="Pingouin.anderson" href="#Pingouin.anderson"><code>Pingouin.anderson</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">anderson(x[, dist])</code></pre><p>Anderson-Darling test of distribution.</p><p><strong>Arguments</strong></p><ul><li><code>x::Array{&lt;:Number}</code>: Array of sample data. May be different lengths. Also support multiple arrays (see examples),</li><li><code>dist::Union{String, Distribution}</code>: Distribution (&quot;norm&quot;, &quot;expon&quot;, &quot;logistic&quot;, &quot;gumbel&quot;).</li></ul><p><strong>Returns</strong></p><ul><li><code>H::Bool</code>: True if data comes from this distribution,</li><li><code>P::Float64</code>: The significance levels for the corresponding critical values in %.</li></ul><p>(See :<code>HypothesisTests.OneSampleADTest</code> for more details).</p><p><strong>Examples</strong></p><ol><li>Test that an array comes from a normal distribution</li></ol><pre><code class="language-julia-repl">julia&gt; x = [2.3, 5.1, 4.3, 2.6, 7.8, 9.2, 1.4]
julia&gt; Pingouin.anderson(x, &quot;norm&quot;)
(false, 8.571428568870942e-5)</code></pre><ol><li>Test that an array comes from a custom distribution</li></ol><pre><code class="language-julia-repl">julia&gt; using Distributions
julia&gt; x = [2.3, 5.1, 4.3, 2.6, 7.8, 9.2, 1.4]
julia&gt; Pingouin.anderson(x, Normal(1,5))
(false, 0.04755873570126501)</code></pre><ol><li>Test that 2 arrays come from a custom distribution</li></ol><pre><code class="language-julia-repl">julia&gt; using Distributions
julia&gt; x = [[2.3, 5.1, 4.3, 2.6, 7.8], [1, 2.0, 3.5, 5.1]]
julia&gt; Pingouin.anderson(x, Normal(1,5))
((true, true), (0.09387808627138938, 0.3413749361130328))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/clementpoiret/Pingouin.jl/blob/6fcc5117a27e5257e0b76947221b27f525d97c3b/src/distributions.jl#L87-L130">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Pingouin.epsilon-Tuple{Union{DataFrames.DataFrame, Array{var&quot;#s29&quot;,N} where N where var&quot;#s29&quot;&lt;:Number}}" href="#Pingouin.epsilon-Tuple{Union{DataFrames.DataFrame, Array{var&quot;#s29&quot;,N} where N where var&quot;#s29&quot;&lt;:Number}}"><code>Pingouin.epsilon</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">epsilon(data[, dv, within, subject, correction])</code></pre><p>Epsilon adjustement factor for repeated measures.</p><p><strong>Arguments</strong></p><ul><li><code>data::Union{Array{&lt;:Number}, DataFrame}</code>: DataFrame containing the repeated measurements. Only long-format dataframe are supported for this function.</li><li><code>dv::Union{Symbol, String, Nothing}</code>: Name of column containing the dependent variable.</li><li><code>within::Union{Array{String}, Array{Symbol}, Symbol, String, Nothing}</code>: Name of column containing the within factor (only required if <code>data</code> is in long format). If <code>within</code> is a list with two strings, this function computes the epsilon factor for the interaction between the two within-subject factor.</li><li><code>subject::Union{Symbol, String, Nothing}</code>: Name of column containing the subject identifier (only required if <code>data</code> is in long format).</li><li><code>correction::String</code>: Specify the epsilon version:<ul><li><code>&quot;gg&quot;</code>: Greenhouse-Geisser,</li><li><code>&quot;hf&quot;</code>: Huynh-Feldt,</li><li><code>&quot;lb&quot;</code>: Lower bound.</li></ul></li></ul><p><strong>Returns</strong></p><p>eps::Float64: Epsilon adjustement factor.</p><p><strong>See Also</strong></p><ul><li><a href="#Pingouin.sphericity-Tuple{DataFrames.DataFrame}"><code>sphericity</code></a>: Mauchly and JNS test for sphericity.</li><li><a href="#Pingouin.homoscedasticity-Tuple{Array{Array{T,1},1} where T&lt;:Number}"><code>homoscedasticity</code></a>: Test equality of variance.</li></ul><p><strong>Notes</strong></p><p>The lower bound epsilon is:</p><div>\[lb = \frac{1}{\text{dof}}\]</div><p>,</p><p>where the degrees of freedom <span>$\text{dof}$</span> is the number of groups <span>$k$</span> minus 1 for one-way design and <span>$(k_1 - 1)(k_2 - 1)$</span> for two-way design</p><p>The Greenhouse-Geisser epsilon is given by:</p><div>\[\epsilon_{GG} = \frac{k^2(\overline{\text{diag}(S)} - \overline{S})^2}{(k-1)(\sum_{i=1}^{k}\sum_{j=1}^{k}s_{ij}^2 - 2k\sum_{j=1}^{k}\overline{s_i}^2 + k^2\overline{S}^2)}\]</div><p>where <span>$S$</span> is the covariance matrix, <span>$\overline{S}$</span> the grandmean of S and <span>$\overline{\text{diag}(S)}$</span> the mean of all the elements on the diagonal of S (i.e. mean of the variances).</p><p>The Huynh-Feldt epsilon is given by:</p><div>\[\epsilon_{HF} = \frac{n(k-1)\epsilon_{GG}-2}{(k-1) (n-1-(k-1)\epsilon_{GG})}\]</div><p>where <span>$n$</span> is the number of observations.</p><p>Missing values are automatically removed from data (listwise deletion).</p><p><strong>Examples</strong></p><p>Using a wide-format dataframe</p><pre><code class="language-julia-repl">julia&gt; data = DataFrame(A = [2.2, 3.1, 4.3, 4.1, 7.2],
                     B = [1.1, 2.5, 4.1, 5.2, 6.4],
                     C = [8.2, 4.5, 3.4, 6.2, 7.2])
julia&gt; Pingouin.epsilon(data, correction=&quot;gg&quot;)
0.5587754577585018
julia&gt; Pingouin.epsilon(data, correction=&quot;hf&quot;)
0.6223448311539789
julia&gt; Pingouin.epsilon(data, correction=&quot;lb&quot;)
0.5</code></pre><p>Now using a long-format dataframe</p><pre><code class="language-julia-repl">julia&gt; data = Pingouin.read_dataset(&quot;rm_anova2&quot;)
julia&gt; head(data)
6×4 DataFrame
│ Row │ Subject │ Time   │ Metric  │ Performance │
│     │ Int64   │ String │ String  │ Int64       │
├─────┼─────────┼────────┼─────────┼─────────────┤
│ 1   │ 1       │ Pre    │ Product │ 13          │
│ 2   │ 2       │ Pre    │ Product │ 12          │
│ 3   │ 3       │ Pre    │ Product │ 17          │
│ 4   │ 4       │ Pre    │ Product │ 12          │
│ 5   │ 5       │ Pre    │ Product │ 19          │
│ 6   │ 6       │ Pre    │ Product │ 6           │</code></pre><p>Let&#39;s first calculate the epsilon of the <em>Time</em> within-subject factor</p><pre><code class="language-julia-repl">julia&gt; Pingouin.epsilon(data, dv=&quot;Performance&quot;, subject=&quot;Subject&quot;,
                     within=&quot;Time&quot;)
1.0</code></pre><p>Since <em>Time</em> has only two levels (Pre and Post), the sphericity assumption is necessarily met, and therefore the epsilon adjustement factor is 1.</p><p>The <em>Metric</em> factor, however, has three levels:</p><pre><code class="language-julia-repl">julia&gt; Pingouin.epsilon(data, dv=:Performance, subject=:Subject,
                     within=[:Metric])
0.9691029584899762</code></pre><p>The epsilon value is very close to 1, meaning that there is no major violation of sphericity.</p><p>Now, let&#39;s calculate the epsilon for the interaction between the two repeated measures factor:</p><pre><code class="language-julia-repl">julia&gt; Pingouin.epsilon(data, dv=:Performance, subject=:Subject,
                     within=[:Time, :Metric])
0.727166420214127</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/clementpoiret/Pingouin.jl/blob/6fcc5117a27e5257e0b76947221b27f525d97c3b/src/distributions.jl#L832-L946">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Pingouin.gzscore-Tuple{Array{var&quot;#s33&quot;,N} where N where var&quot;#s33&quot;&lt;:Number}" href="#Pingouin.gzscore-Tuple{Array{var&quot;#s33&quot;,N} where N where var&quot;#s33&quot;&lt;:Number}"><code>Pingouin.gzscore</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">gzscore(x)</code></pre><p>Geometric standard (Z) score.</p><p><strong>Arguments</strong></p><ul><li><code>x::Array{&lt;:Number}</code>: Array of raw values</li></ul><p><strong>Returns</strong></p><ul><li><code>gzscore::Array{&lt;:Number}</code>: Array of geometric z-scores (same shape as x)</li></ul><p><strong>Notes</strong></p><p>Geometric Z-scores are better measures of dispersion than arithmetic z-scores when the sample data come from a log-normally distributed population [1].</p><p>Given the raw scores <span>$x$</span>, the geometric mean <span>$\mu_g$</span> and the geometric standard deviation <span>$\sigma_g$</span>, the standard score is given by the formula:</p><div>\[z = \frac{log(x) - log(\mu_g)}{log(\sigma_g)}\]</div><p><strong>References</strong></p><p>[1] https://en.wikipedia.org/wiki/Geometric<em>standard</em>deviation</p><p><strong>Examples</strong></p><p>Standardize a lognormal-distributed vector:</p><pre><code class="language-julia-repl">julia&gt; raw = [1,4,5,4,1,2,5,8,6,6,9,8,3]
julia&gt; z = Pingouin.gzscore(raw)
13-element Array{Float64,1}:
 -1.8599725059104346
  0.03137685347921089
  0.3358161014965816
  0.03137685347921089
 -1.8599725059104346
  ⋮
  0.5845610789821727
  0.5845610789821727
  1.1377453044851344
  0.9770515331740336
 -0.3611136007126501</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/clementpoiret/Pingouin.jl/blob/6fcc5117a27e5257e0b76947221b27f525d97c3b/src/distributions.jl#L12-L61">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Pingouin.homoscedasticity-Tuple{Array{Array{T,1},1} where T&lt;:Number}" href="#Pingouin.homoscedasticity-Tuple{Array{Array{T,1},1} where T&lt;:Number}"><code>Pingouin.homoscedasticity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">homoscedasticity(data[, dv, group, method, α])</code></pre><p>Test equality of variance.</p><p><strong>Arguments</strong></p><ul><li><code>data</code>: Iterable. Can be either an Array iterables or a wide- or long-format dataframe.</li><li><code>dv::Union{Symbol, String, Nothing}</code>: Dependent variable (only when <span>$data$</span> is a long-format dataframe).</li><li><code>group::Union{Symbol, String, Nothing}</code>: Grouping variable (only when <span>$data$</span> is a long-format dataframe).</li><li><code>method::String</code>: Statistical test. <code>&#39;levene&#39;</code> (default) performs the Levene test and <code>&#39;bartlett&#39;</code> performs the Bartlett test. The former is more robust to departure from normality.</li><li><code>α::Float64</code>: Significance level.</li></ul><p><strong>Returns</strong></p><ul><li><code>stats::DataFrame</code>:<ul><li><code>W/T</code>: Test statistic (&#39;W&#39; for Levene, &#39;T&#39; for Bartlett), </li><li><code>pval</code>: p-value,</li><li><code>equal_var</code>: true if <code>data</code> has equal variance.</li></ul></li></ul><p><strong>See Also</strong></p><ul><li><a href="#Pingouin.normality-Tuple{DataFrames.DataFrame,Union{String, Symbol},Union{String, Symbol}}"><code>normality</code></a> : Univariate normality test.</li><li><a href="#Pingouin.sphericity-Tuple{DataFrames.DataFrame}"><code>sphericity</code></a> : Mauchly&#39;s test for sphericity.</li></ul><p><strong>Notes</strong></p><p>The <strong>Bartlett</strong> <span>$T$</span> statistic [1] is defined as:</p><div>\[T = \frac{(N-k) \ln{s^{2}_{p}} - \sum_{i=1}^{k}(N_{i} - 1) \ln{s^{2}_{i}}}{1 + (1/(3(k-1)))((\sum_{i=1}^{k}{1/(N_{i} - 1))} - 1/(N-k))}\]</div><p>where <span>$s_i^2$</span> is the variance of the <span>$i^{th}$</span> group, <span>$N$</span> is the total sample size, <span>$N_i$</span> is the sample size of the <span>$i^{th}$</span> group, <span>$k$</span> is the number of groups, and <span>$s_p^2$</span> is the pooled variance.</p><p>The pooled variance is a weighted average of the group variances and is defined as:</p><div>\[s^{2}_{p} = \sum_{i=1}^{k}(N_{i} - 1)s^{2}_{i}/(N-k)\]</div><p>The p-value is then computed using a chi-square distribution:</p><div>\[T \sim \chi^2(k-1)\]</div><p>The <strong>Levene</strong> <span>$W$</span> statistic [2] is defined as:</p><div>\[W = \frac{(N-k)} {(k-1)} \frac{\sum_{i=1}^{k}N_{i}(\overline{Z}_{i.}-\overline{Z})^{2} } {\sum_{i=1}^{k}\sum_{j=1}^{N_i}(Z_{ij}-\overline{Z}_{i.})^{2} }\]</div><p>where <span>$Z_{ij} = |Y_{ij} - \text{median}({Y}_{i.})|$</span>, <span>$\overline{Z}_{i.}$</span> are the group means of <span>$Z_{ij}$</span> and <span>$\overline{Z}$</span> is the grand mean of <span>$Z_{ij}$</span>.</p><p>The p-value is then computed using a F-distribution:</p><div>\[W \sim F(k-1, N-k)\]</div><p><strong>WARNING:</strong> Missing values are not supported for this function. Make sure to remove them before.</p><p><strong>References</strong></p><p>[1] Bartlett, M. S. (1937). Properties of sufficiency and statistical tests. Proc. R. Soc. Lond. A, 160(901), 268-282.</p><p>[2] Brown, M. B., &amp; Forsythe, A. B. (1974). Robust tests for the equality of variances. Journal of the American Statistical Association, 69(346), 364-367.</p><p><strong>Examples</strong></p><ol><li>Levene test on a wide-format dataframe</li></ol><pre><code class="language-julia-repl">julia&gt; data = Pingouin.read_dataset(&quot;mediation&quot;);
julia&gt; Pingouin.homoscedasticity(data[[&quot;X&quot;, &quot;Y&quot;, &quot;M&quot;]])
1×3 DataFrame
│ Row │ W       │ pval     │ equal_var │
│     │ Float64 │ Float64  │ Bool      │
├─────┼─────────┼──────────┼───────────┤
│ 1   │ 1.17352 │ 0.310707 │ 1         │</code></pre><ol><li>Bartlett test using an array of arrays</li></ol><pre><code class="language-julia-repl">julia&gt; data = [[4, 8, 9, 20, 14], [5, 8, 15, 45, 12]];
julia&gt; Pingouin.homoscedasticity(data, method=&quot;bartlett&quot;, α=.05)
1×3 DataFrame
│ Row │ T       │ pval     │ equal_var │
│     │ Float64 │ Float64  │ Bool      │
├─────┼─────────┼──────────┼───────────┤
│ 1   │ 2.87357 │ 0.090045 │ 1         │</code></pre><ol><li>Long-format dataframe</li></ol><pre><code class="language-julia-repl">julia&gt; data = Pingouin.read_dataset(&quot;rm_anova2&quot;);
julia&gt; Pingouin.homoscedasticity(data, &quot;Performance&quot;, &quot;Time&quot;)
1×3 DataFrame
│ Row │ W       │ pval      │ equal_var │
│     │ Float64 │ Float64   │ Bool      │
├─────┼─────────┼───────────┼───────────┤
│ 1   │ 3.1922  │ 0.0792169 │ 1         │</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/clementpoiret/Pingouin.jl/blob/6fcc5117a27e5257e0b76947221b27f525d97c3b/src/distributions.jl#L403-L509">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Pingouin.normality-Tuple{DataFrames.DataFrame,Union{String, Symbol},Union{String, Symbol}}" href="#Pingouin.normality-Tuple{DataFrames.DataFrame,Union{String, Symbol},Union{String, Symbol}}"><code>Pingouin.normality</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">normality(data[, dv, group, method, α])</code></pre><p>Univariate normality test.</p><p><strong>Arguments</strong></p><ul><li><code>data</code>: Iterable. Can be either a single list, 1D array, or a wide- or long-format dataframe.</li><li><code>dv::Union{Symbol, String, Nothing}</code>: Dependent variable (only when <span>$data$</span> is a long-format dataframe).</li><li><code>group::Union{Symbol, String, Nothing}</code>: Grouping variable (only when <span>$data$</span> is a long-format dataframe).</li><li><code>method::String</code>: Normality test. <code>&#39;shapiro&#39;</code> (default) performs the Shapiro-Wilk test using the AS R94 algorithm. If the kurtosis is higher than 3, it  performs a Shapiro-Francia test for leptokurtic distributions. Supported values: [&quot;shapiro&quot;, &quot;jarque_bera&quot;].</li><li><code>α::Float64</code>: Significance level.</li></ul><p><strong>Returns</strong></p><ul><li><code>stats::DataFrame</code>:<ul><li><code>W</code>: Test statistic,</li><li><code>pval</code>: p-value,</li><li><code>normal</code>: true if <code>data</code> is normally distributed.</li></ul></li></ul><p><strong>See Also</strong></p><ul><li><a href="#Pingouin.homoscedasticity-Tuple{Array{Array{T,1},1} where T&lt;:Number}"><code>homoscedasticity</code></a>: Test equality of variance.</li><li><a href="#Pingouin.sphericity-Tuple{DataFrames.DataFrame}"><code>sphericity</code></a>: Mauchly&#39;s test for sphericity.</li></ul><p><strong>Notes</strong></p><p>The Shapiro-Wilk test calculates a :math:<code>W</code> statistic that tests whether a random sample <span>$x_1, x_2, ..., x_n$</span> comes from a normal distribution.</p><p>The <span>$W$</span> is normalized (<span>$W = (W - μ) / σ$</span>)</p><p>The null-hypothesis of this test is that the population is normally distributed. Thus, if the p-value is less than the chosen alpha level (typically set at 0.05), then the null hypothesis is rejected and there is evidence that the data tested are not normally distributed.</p><p>The result of the Shapiro-Wilk test should be interpreted with caution in the case of large sample sizes (&gt;5000). Indeed, quoting from <a href="https://en.wikipedia.org/wiki/Shapiro%E2%80%93Wilk_test">Wikipedia</a>:</p><p><em>&quot;Like most statistical significance tests, if the sample size is sufficiently large this test may detect even trivial departures from the null hypothesis (i.e., although there may be some statistically significant effect, it may be too small to be of any practical significance); thus, additional investigation of the effect size is typically advisable, e.g., a Q–Q plot in this case.&quot;</em></p><p>The Jarque-Bera statistic is to test the null hypothesis that a real-valued vector <span>$y$</span> is normally distributed. Note that the approximation by the Chi-squared distribution does not work well and the speed of convergence is slow. In small samples, the test tends to be over-sized for nominal levels up to about 3% and under-sized for larger nominal levels (Mantalos, 2010).</p><p>Note that missing values are automatically removed (casewise deletion).</p><p><strong>References</strong></p><ul><li>Shapiro, S. S., &amp; Wilk, M. B. (1965). An analysis of variance test</li></ul><p>for normality (complete samples). Biometrika, 52(3/4), 591-611.</p><ul><li>Panagiotis Mantalos, 2011, &quot;The three different measures of the sample skewness and</li></ul><p>kurtosis and the effects to the Jarque-Bera test for normality&quot;, International Journal of Computational Economics and Econometrics, Vol. 2, No. 1, <a href="http://dx.doi.org/10.1504/IJCEE.2011.040576">link</a>.</p><ul><li><p>https://www.itl.nist.gov/div898/handbook/prc/section2/prc213.htm</p></li><li><p><a href="https://en.wikipedia.org/wiki/Jarque–Bera_test">Jarque-Bera test on Wikipedia</a></p></li></ul><p><strong>Examples</strong></p><ol><li>Shapiro-Wilk test on a 1D array</li></ol><pre><code class="language-julia-repl">julia&gt; dataset = Pingouin.read_dataset(&quot;anova&quot;)
julia&gt; Pingouin.normality(dataset[&quot;Pain threshold&quot;])
1×3 DataFrame
│ Row │ W        │ pval     │ normal │
│     │ Float64  │ Float64  │ Bool   │
├─────┼──────────┼──────────┼────────┤
│ 1   │ 0.971204 │ 0.800257 │ 1      │</code></pre><ol><li>Wide-format dataframe using Jarque-Bera test</li></ol><pre><code class="language-julia-repl">julia&gt; dataset = Pingouin.read_dataset(&quot;mediation&quot;)
julia&gt; Pingouin.normality(dataset, method=&quot;jarque_bera&quot;)
7×4 DataFrame
│ Row │ dv     │ W        │ pval        │ normal │
│     │ Symbol │ Float64  │ Float64     │ Bool   │
├─────┼────────┼──────────┼─────────────┼────────┤
│ 1   │ X      │ 1.42418  │ 0.490618    │ 1      │
│ 2   │ M      │ 0.645823 │ 0.724038    │ 1      │
│ 3   │ Y      │ 0.261805 │ 0.877303    │ 1      │
│ 4   │ Mbin   │ 16.6735  │ 0.000239553 │ 0      │
│ 5   │ Ybin   │ 16.6675  │ 0.000240265 │ 0      │
│ 6   │ W1     │ 5.40923  │ 0.0668961   │ 1      │
│ 7   │ W2     │ 80.6857  │ 3.01529e-18 │ 0      │</code></pre><ol><li>Long-format dataframe</li></ol><pre><code class="language-julia-repl">julia&gt; dataset = Pingouin.read_dataset(&quot;rm_anova2&quot;)
julia&gt; Pingouin.normality(dataset, :Performance, :Time)
2×4 DataFrame
│ Row │ Time   │ W        │ pval      │ normal │
│     │ String │ Float64  │ Float64   │ Bool   │
├─────┼────────┼──────────┼───────────┼────────┤
│ 1   │ Pre    │ 0.967718 │ 0.478771  │ 1      │
│ 2   │ Post   │ 0.940728 │ 0.0951576 │ 1      │</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/clementpoiret/Pingouin.jl/blob/6fcc5117a27e5257e0b76947221b27f525d97c3b/src/distributions.jl#L224-L339">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Pingouin.sphericity-Tuple{DataFrames.DataFrame}" href="#Pingouin.sphericity-Tuple{DataFrames.DataFrame}"><code>Pingouin.sphericity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">sphericity(data[, dv, within, subject, method, α])</code></pre><p>Mauchly and JNS test for sphericity.</p><p><strong>Arguments</strong></p><ul><li><code>data::DataFrame</code>: DataFrame containing the repeated measurements. Only long-format dataframe are supported for this function.</li><li><code>dv::Union{Nothing, String, Symbol}</code>: Name of column containing the dependent variable.</li><li><code>within::Union{Array{String}, Array{Symbol}, Nothing, String, Symbol}</code>: Name of column containing the within factor. If <code>within</code> is a list with two strings, this function computes the epsilon factor for the interaction between the two within-subject factor.</li><li><code>subject::Union{Nothing, String, Symbol}</code>: Name of column containing the subject identifier (only required if <code>data</code> is in long format).</li><li><code>method::String</code>: Method to compute sphericity:<ul><li><code>&quot;jns&quot;</code>: John, Nagao and Sugiura test.</li><li><code>&quot;mauchly&quot;</code>: Mauchly test (default).</li></ul></li><li><code>α::Float64</code>: Significance level</li></ul><p><strong>Returns</strong></p><ul><li><code>spher::Bool</code>: True if data have the sphericity property.</li><li><code>W::Float64:</code> Test statistic.</li><li><code>chi2::Float64</code>: Chi-square statistic.</li><li><code>dof::Int64</code>:  Degrees of freedom.</li><li><code>pval::Flot64</code>: P-value.</li></ul><p><strong>Throwing</strong></p><p><code>DomainError</code> When testing for an interaction, if both within-subject factors have more than 2 levels (not yet supported in Pingouin).</p><p><strong>See Also</strong></p><ul><li><a href="#Pingouin.epsilon-Tuple{Union{DataFrames.DataFrame, Array{var&quot;#s29&quot;,N} where N where var&quot;#s29&quot;&lt;:Number}}"><code>epsilon</code></a>: Epsilon adjustement factor for repeated measures.</li><li><a href="#Pingouin.homoscedasticity-Tuple{Array{Array{T,1},1} where T&lt;:Number}"><code>homoscedasticity</code></a>: Test equality of variance.</li><li><a href="#Pingouin.normality-Tuple{DataFrames.DataFrame,Union{String, Symbol},Union{String, Symbol}}"><code>normality</code></a>: Univariate normality test.</li></ul><p><strong>Notes</strong></p><p>The <strong>Mauchly</strong> <span>$W$</span> statistic [1] is defined by:</p><div>\[W = \frac{\prod \lambda_j}{(\frac{1}{k-1} \sum \lambda_j)^{k-1}}\]</div><p>where <span>$\lambda_j$</span> are the eigenvalues of the population covariance matrix (= double-centered sample covariance matrix) and <span>$k$</span> is the number of conditions.</p><p>From then, the <span>$W$</span> statistic is transformed into a chi-square score using the number of observations per condition <span>$n$</span></p><div>\[f = \frac{2(k-1)^2+k+1}{6(k-1)(n-1)}\]</div><div>\[\chi_w^2 = (f-1)(n-1) \text{log}(W)\]</div><p>The p-value is then approximated using a chi-square distribution:</p><div>\[\chi_w^2 \sim \chi^2(\frac{k(k-1)}{2}-1)\]</div><p>The <strong>JNS</strong> <span>$V$</span> statistic ([2], [3], [4]) is defined by:</p><div>\[V = \frac{(\sum_j^{k-1} \lambda_j)^2}{\sum_j^{k-1} \lambda_j^2}\]</div><div>\[\chi_v^2 = \frac{n}{2}  (k-1)^2 (V - \frac{1}{k-1})\]</div><p>and the p-value approximated using a chi-square distribution</p><div>\[\chi_v^2 \sim \chi^2(\frac{k(k-1)}{2}-1)\]</div><p>Missing values are automatically removed from <code>data</code> (listwise deletion).</p><p><strong>References</strong></p><p>[1] Mauchly, J. W. (1940). Significance test for sphericity of a normal n-variate distribution. The Annals of Mathematical Statistics, 11(2), 204-209.</p><p>[2] Nagao, H. (1973). On some test criteria for covariance matrix. The Annals of Statistics, 700-709.</p><p>[3] Sugiura, N. (1972). Locally best invariant test for sphericity and the limiting distributions. The Annals of Mathematical Statistics, 1312-1316.</p><p>[4] John, S. (1972). The distribution of a statistic used for testing sphericity of normal distributions. Biometrika, 59(1), 169-173.</p><p>See also http://www.real-statistics.com/anova-repeated-measures/sphericity/</p><p><strong>Examples</strong></p><p>Mauchly test for sphericity using a wide-format dataframe</p><pre><code class="language-julia-repl">julia&gt; data = DataFrame(A = [2.2, 3.1, 4.3, 4.1, 7.2],
                     B = [1.1, 2.5, 4.1, 5.2, 6.4],
                     C = [8.2, 4.5, 3.4, 6.2, 7.2])
julia&gt; Pingouin.sphericity(data)
│ Row │ spher │ W        │ chi2    │ dof     │ pval      │
│     │ Bool  │ Float64  │ Float64 │ Float64 │ Float64   │
├─────┼───────┼──────────┼─────────┼─────────┼───────────┤
│ 1   │ 1     │ 0.210372 │ 4.67663 │ 2.0     │ 0.0964902 │</code></pre><p>John, Nagao and Sugiura (JNS) test</p><pre><code class="language-julia-repl">julia&gt; Pingouin.sphericity(data, method=&quot;jns&quot;)[:pval]  # P-value only
0.045604240307520305</code></pre><p>Now using a long-format dataframe</p><pre><code class="language-julia-repl">julia&gt; data = Pingouin.read_dataset(&quot;rm_anova2&quot;)
julia&gt; head(data)
6x4 DataFrame
│ Row │ Subject │ Time   │ Metric  │ Performance │
│     │ Int64   │ String │ String  │ Int64       │
├─────┼─────────┼────────┼─────────┼─────────────┤
│ 1   │ 1       │ Pre    │ Product │ 13          │
│ 2   │ 2       │ Pre    │ Product │ 12          │
│ 3   │ 3       │ Pre    │ Product │ 17          │
│ 4   │ 4       │ Pre    │ Product │ 12          │
│ 5   │ 5       │ Pre    │ Product │ 19          │
│ 6   │ 6       │ Pre    │ Product │ 6           │</code></pre><p>Let&#39;s first test sphericity for the <em>Time</em> within-subject factor</p><pre><code class="language-julia-repl">julia&gt; Pingouin.sphericity(data, dv=:Performance, subject=:Subject,
                        within=:Time)
│ Row │ spher │ W       │ chi2    │ dof   │ pval    │
│     │ Bool  │ Float64 │ Float64 │ Int64 │ Float64 │
├─────┼───────┼─────────┼─────────┼───────┼─────────┤
│ 1   │ 1     │ NaN     │ NaN     │ 1     │ 1.0     │</code></pre><p>Since <em>Time</em> has only two levels (Pre and Post), the sphericity assumption is necessarily met.</p><p>The <em>Metric</em> factor, however, has three levels:</p><pre><code class="language-julia-repl">julia&gt; Pingouin.sphericity(data, dv=&quot;Performance&quot;, subject=&quot;Subject&quot;,
                        within=[&quot;Metric&quot;])[:pval]
0.8784417991645139</code></pre><p>The p-value value is very large, and the test therefore indicates that there is no violation of sphericity.</p><p>Now, let&#39;s calculate the epsilon for the interaction between the two repeated measures factor. The current implementation in Pingouin only works if at least one of the two within-subject factors has no more than two levels.</p><pre><code class="language-julia-repl">julia&gt; Pingouin.sphericity(data, dv=&quot;Performance&quot;,
                        subject=&quot;Subject&quot;,
                        within=[&quot;Time&quot;, &quot;Metric&quot;])
│ Row │ spher │ W        │ chi2    │ dof     │ pval     │
│     │ Bool  │ Float64  │ Float64 │ Float64 │ Float64  │
├─────┼───────┼──────────┼─────────┼─────────┼──────────┤
│ 1   │ 1     │ 0.624799 │ 3.7626  │ 2.0     │ 0.152392 │</code></pre><p>Here again, there is no violation of sphericity acccording to Mauchly&#39;s test.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/clementpoiret/Pingouin.jl/blob/6fcc5117a27e5257e0b76947221b27f525d97c3b/src/distributions.jl#L579-L744">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../datasets/">« Datasets</a><a class="docs-footer-nextpage" href="../effsize/">Effect Sizes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Saturday 21 November 2020 17:56">Saturday 21 November 2020</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
