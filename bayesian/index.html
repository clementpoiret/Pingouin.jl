<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian · Pingouin</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Pingouin</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Pingouin.jl Documentation</a></li><li><a class="tocitem" href="../datasets/">Datasets</a></li><li><a class="tocitem" href="../distributions/">Distributions</a></li><li><a class="tocitem" href="../effsize/">Effect Sizes</a></li><li class="is-active"><a class="tocitem" href>Bayesian</a></li><li><a class="tocitem" href="../nonparametric/">Non-Parametric Tests</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Bayesian</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/clementpoiret/Pingouin.jl/blob/master/docs/src/bayesian.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Bayesian"><a class="docs-heading-anchor" href="#Bayesian">Bayesian</a><a id="Bayesian-1"></a><a class="docs-heading-anchor-permalink" href="#Bayesian" title="Permalink"></a></h1><p>Bayesian tests, mostly focused around BF10 and BF01.</p><article class="docstring"><header><a class="docstring-binding" id="Pingouin.bayesfactor_binom" href="#Pingouin.bayesfactor_binom"><code>Pingouin.bayesfactor_binom</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">bayesfactor_binom(k, n, p)</code></pre><p>Bayes factor of a binomial test with <span>$k$</span> successes, <span>$n$</span> trials and base probability <span>$p$</span>.</p><p><strong>Arguments</strong></p><ul><li><code>k::Int64</code>: Number of successes.</li><li><code>n::Int64</code>: Number of trials.</li><li><code>p::Float64</code>: Base probability of success (range from 0 to 1).</li></ul><p><strong>Returns</strong></p><ul><li><code>binom_bf::Float64</code>: The Bayes Factor quantifies the evidence in favour of the alternative hypothesis, where the null hypothesis is that the random variable is binomially distributed with base probability <span>$p$</span>.</li></ul><p><strong>See also</strong></p><ul><li><a href="#Pingouin.bayesfactor_pearson-Tuple{Float64,Int64}"><code>bayesfactor_pearson</code></a>: Bayes Factor of a correlation</li><li><a href="#Pingouin.bayesfactor_ttest"><code>bayesfactor_ttest</code></a>: Bayes Factor of a T-test</li></ul><p><strong>Notes</strong></p><p>Adapted from a Matlab code found at https://github.com/anne-urai/Tools/blob/master/stats/BayesFactors/binombf.m The Bayes Factor is given by the formula below:</p><p class="math-container">\[BF_{10} = \frac{\int_0^1 \binom{n}{k}g^k(1-g)^{n-k}} {\binom{n}{k} p^k (1-p)^{n-k}}\]</p><p><strong>References</strong></p><ul><li>http://pcl.missouri.edu/bf-binomial</li><li>https://en.wikipedia.org/wiki/Bayes_factor</li></ul><p><strong>Examples</strong></p><p>We want to determine if a coin is fair. After tossing the coin 200 times in a row, we report 115 heads (hereafter referred to as &quot;successes&quot;) and 85 tails (&quot;failures&quot;). The Bayes Factor can be easily computed using Pingouin:</p><pre><code class="language-julia-repl">julia&gt; using Pingouin
julia&gt; bf = Pingouin.bayesfactor_binom(115, 200, 0.5)
julia&gt; # Note that Pingouin returns the BF-alt by default.
julia&gt; # BF-null is simply 1 / BF-alt
julia&gt; print(&quot;BF-null: &quot;, 1 / bf, &quot;; BF-alt: &quot;, bf)
BF-null: 1.197134330237552; BF-alt: 0.8353281455069175</code></pre><p>Since the Bayes Factor of the null hypothesis (&quot;the coin is fair&quot;) is higher than the Bayes Factor of the alternative hypothesis (&quot;the coin is not fair&quot;), we can conclude that there is more evidence to support the fact that the coin is indeed fair. However, the strength of the evidence in favor of the null hypothesis (1.197) is &quot;barely worth mentionning&quot; according to Jeffreys&#39;s rule of thumb.</p><p>Interestingly, a frequentist alternative to this test would give very different results. It can be performed using the <code>SciPy.stats.binom_test</code> function:</p><pre><code class="language-julia-repl">julia&gt; using SciPy
julia&gt; pval = SciPy.stats.binom_test(115, 200, p=0.5)
julia&gt; round.(pval, digits=5)
0.04004</code></pre><p>The binomial test rejects the null hypothesis that the coin is fair at the 5% significance level (p=0.04). Thus, whereas a frequentist hypothesis test would yield significant results at the 5% significance level, the Bayes factor does not find any evidence that the coin is unfair. Last example using a different base probability of successes</p><pre><code class="language-julia-repl">julia&gt; bf = Pingouin.bayesfactor_binom(100, 1000, 0.1)
julia&gt; print(&quot;Bayes Factor: &quot;, round.(bf, digits=3))
Bayes Factor: 0.024</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/clementpoiret/Pingouin.jl/blob/f0c1467bf2447643b821f24c6ff36e373cedcd60/src/bayesian.jl#L6-L84">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Pingouin.bayesfactor_pearson-Tuple{Float64,Int64}" href="#Pingouin.bayesfactor_pearson-Tuple{Float64,Int64}"><code>Pingouin.bayesfactor_pearson</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">bayesfactor_pearson(r, n[, tail, method, kappa])</code></pre><p>Bayes Factor of a Pearson correlation.</p><p><strong>Arguments</strong></p><ul><li><code>r::Float64</code>: Pearson correlation coefficient.</li><li><code>n::Int64</code>: Sample size.</li><li><code>tail::String</code>: Tail of the alternative hypothesis. Can be <em>&#39;two-sided&#39;</em>, <em>&#39;one-sided&#39;</em>, <em>&#39;greater&#39;</em> or <em>&#39;less&#39;</em>. <em>&#39;greater&#39;</em> corresponds to a positive correlation, <em>&#39;less&#39;</em> to a negative correlation. If <em>&#39;one-sided&#39;</em>, the directionality is inferred based on the <span>$r$</span> value (= <em>&#39;greater&#39;</em> if <span>$r$</span> &gt; 0, <em>&#39;less&#39;</em> if <span>$r$</span> &lt; 0).</li><li><code>method::String</code>: Method to compute the Bayes Factor. Can be <em>&#39;ly&#39;</em> (default) or <em>&#39;wetzels&#39;</em>. The former has an exact analytical solution, while the latter requires integral solving (and is therefore slower). <em>&#39;wetzels&#39;</em> was the default in Pingouin &lt;= 0.2.5. See Notes for details.</li><li><code>kappa::Float64</code>: Kappa factor. This is sometimes called the <em>rscale</em> parameter, and</li></ul><p>is only used when <span>$method$</span> is <em>&#39;ly&#39;</em>.</p><p><strong>Returns</strong></p><ul><li><code>bf::Float64</code>: Bayes Factor (BF10).</li></ul><p>The Bayes Factor quantifies the evidence in favour of the alternative hypothesis.</p><p><strong>See also</strong></p><ul><li><a href="@ref"><code>corr</code></a>: (Robust) correlation between two variables,</li><li><a href="@ref"><code>pairwise_corr</code></a>: Pairwise correlation between columns of a pandas DataFrame,</li><li><a href="#Pingouin.bayesfactor_ttest"><code>bayesfactor_ttest</code></a>: Bayes Factor of a T-test,</li><li><a href="#Pingouin.bayesfactor_binom"><code>bayesfactor_binom</code></a>: Bayes Factor of a binomial test.</li></ul><p><strong>Notes</strong></p><p>To compute the Bayes Factor directly from the raw data, use the <code>pingouin.corr</code> function. The two-sided <strong>Wetzels Bayes Factor</strong> (also called <em>JZS Bayes Factor</em>) is calculated using the equation 13 and associated R code of [1]:</p><p class="math-container">\[\text{BF}_{10}(n, r) = \frac{\sqrt{n/2}}{\gamma(1/2)}* \int_{0}^{\infty}e((n-2)/2)* log(1+g)+(-(n-1)/2)log(1+(1-r^2)*g)+(-3/2)log(g)-n/2g\]</p><p>where <span>$n$</span> is the sample size, <span>$r$</span> is the Pearson correlation coefficient and <span>$g$</span> is is an auxiliary variable that is integrated out numerically. Since the Wetzels Bayes Factor requires solving an integral, it is slower than the analytical solution described below. The two-sided <strong>Ly Bayes Factor</strong> (also called <em>Jeffreys exact Bayes Factor</em>) is calculated using equation 25 of [2]:</p><p class="math-container">\[\text{BF}_{10;k}(n, r) = \frac{2^{\frac{k-2}{k}}\sqrt{\pi}} {\beta(\frac{1}{k}, \frac{1}{k})} \cdot \frac{\Gamma(\frac{2+k(n-1)}{2k})}{\Gamma(\frac{2+nk}{2k})} \cdot 2F_1(\frac{n-1}{2}, \frac{n-1}{2}, \frac{2+nk}{2k}, r^2)\]</p><p>The one-sided version is described in eq. 27 and 28 of Ly et al, 2016. Please take note that the one-sided test requires the <a href="http://mpmath.org/">mpmath</a> package. Results have been validated against JASP and the BayesFactor R package.</p><p><strong>References</strong></p><p>[1] Ly, A., Verhagen, J. &amp; Wagenmakers, E.-J. Harold Jeffreys’s default Bayes factor hypothesis tests: Explanation, extension, and application in psychology. J. Math. Psychol. 72, 19–32 (2016).</p><p>[2] Wetzels, R. &amp; Wagenmakers, E.-J. A default Bayesian hypothesis test for correlations and partial correlations. Psychon. Bull. Rev. 19, 1057–1064 (2012).</p><p><strong>Examples</strong></p><p>Bayes Factor of a Pearson correlation</p><pre><code class="language-julia-repl">julia&gt; using Pingouin
julia&gt; r, n = 0.6, 20
julia&gt; bf = Pingouin.bayesfactor_pearson(r, n)
julia&gt; print(&quot;Bayes Factor: &quot;, round.(bf, digits=3))
Bayes Factor: 10.634</code></pre><p>Compare to Wetzels method:</p><pre><code class="language-julia-repl">julia&gt; bf = Pingouin.bayesfactor_pearson(r, n,
                                    tail=&quot;two-sided&quot;,
                                    method=&quot;wetzels&quot;,
                                    kappa=1.)
julia&gt; print(&quot;Bayes Factor: &quot;, round.(bf, digits=3))
Bayes Factor: 8.221</code></pre><p>One-sided test</p><pre><code class="language-julia-repl">julia&gt; bf10pos = Pingouin.bayesfactor_pearson(r, n, 
                                         tail=&quot;one-sided&quot;,
                                         method=&quot;ly&quot;,
                                         kappa=1.0)
julia&gt; bf10neg = Pingouin.bayesfactor_pearson(r, n,
                                         tail=&quot;less&quot;,
                                         method=&quot;ly&quot;,
                                         kappa=1.0)
julia&gt; print(&quot;BF-pos: &quot;, round.(bf10pos, digits=3),&quot; BF-neg: &quot;, round.(bf10neg, digits=3))
BF-pos: 21.185, BF-neg: 0.082</code></pre><p>We can also only pass <code>tail=&#39;one-sided&#39;</code> and Pingouin will automatically infer the directionality of the test based on the <span>$r$</span> value.</p><pre><code class="language-julia-repl">julia&gt; print(&quot;BF: &quot;, round.(Pingouin.bayesfactor_pearson(r, n, tail=&quot;one-sided&quot;), digits=3))
BF: 21.185</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/clementpoiret/Pingouin.jl/blob/f0c1467bf2447643b821f24c6ff36e373cedcd60/src/bayesian.jl#L101-L206">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Pingouin.bayesfactor_ttest" href="#Pingouin.bayesfactor_ttest"><code>Pingouin.bayesfactor_ttest</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">bayesfactor_ttest(t, nx[, ny, paired, tail, r])</code></pre><p>Bayes Factor of a T-test.</p><p><strong>Arguments</strong></p><ul><li><code>t::Float64</code>: T-value of the T-test</li><li><code>nx::Int64</code>: Sample size of first group</li><li><code>ny::Int64</code>: Sample size of second group (only needed in case of an independent two-sample T-test)</li><li><code>paired::Bool</code>: boolean Specify whether the two observations are related (i.e. repeated measures) or independent.</li><li><code>tail::String</code>: string Specify whether the test is <code>&#39;one-sided&#39;</code> or <code>&#39;two-sided&#39;</code>. Can also be <code>&#39;greater&#39;</code> or <code>&#39;less&#39;</code> to specify the direction of the test.</li></ul><p><strong>WARNING</strong>: One-sided Bayes Factor (BF) are simply obtained by doubling the two-sided BF, which is not exactly the same behavior as R or JASP. Be extra careful when interpretating one-sided BF, and if you can, always double-check your results.</p><ul><li><code>r::Float64</code>: Cauchy scale factor. Smaller values of <span>$r$</span> (e.g. 0.5), may be appropriate when small effect sizes are expected a priori; larger values of <span>$r$</span> are appropriate when large effect sizes are expected (Rouder et al 2009). The default is <span>$\sqrt{2} / 2 \approx 0.707$</span>.</li></ul><p><strong>Returns</strong></p><ul><li><code>bf::Float64</code>: Scaled Jeffrey-Zellner-Siow (JZS) Bayes Factor (BF10). The Bayes Factor quantifies the evidence in favour of the alternative hypothesis.</li></ul><p><strong>See also</strong></p><ul><li><a href="@ref"><code>ttest</code></a>: T-test</li><li><a href="@ref"><code>pairwise_ttest</code></a>: Pairwise T-tests</li><li><a href="#Pingouin.bayesfactor_pearson-Tuple{Float64,Int64}"><code>bayesfactor_pearson</code></a>: Bayes Factor of a correlation</li><li><a href="#Pingouin.bayesfactor_binom"><code>bayesfactor_binom</code></a>: Bayes Factor of a binomial test</li></ul><p><strong>Notes</strong></p><p>Adapted from a Matlab code found at https://github.com/anne-urai/Tools/tree/master/stats/BayesFactors If you would like to compute the Bayes Factor directly from the raw data instead of from the T-value, use the <a href="@ref"><code>pingouin.ttest</code></a> function. The JZS Bayes Factor is approximated using the formula described in ref [1]:</p><p class="math-container">\[\text{BF}_{10} = \frac{\int_{0}^{\infty}(1 + Ngr^2)^{-1/2} (1 + \frac{t^2}{v(1 + Ngr^2)})^{-(v+1) / 2}(2\pi)^{-1/2}g^ {-3/2}e^{-1/2g}}{(1 + \frac{t^2}{v})^{-(v+1) / 2}}\]</p><p>where <span>$t$</span> is the T-value, <span>$v$</span> the degrees of freedom, <span>$N$</span> the sample size, <span>$r$</span> the Cauchy scale factor (= prior on effect size) and <span>$g$</span> is is an auxiliary variable that is integrated out numerically. Results have been validated against JASP and the BayesFactor R package.</p><p><strong>References</strong></p><p>[1] Rouder, J.N., Speckman, P.L., Sun, D., Morey, R.D., Iverson, G.,</p><ol><li>Bayesian t tests for accepting and rejecting the null hypothesis.</li></ol><p>Psychon. Bull. Rev. 16, 225–237. https://doi.org/10.3758/PBR.16.2.225</p><p><strong>Examples</strong></p><ol><li>Bayes Factor of an independent two-sample T-test</li></ol><pre><code class="language-julia-repl">julia&gt; bf = Pingouin.bayesfactor_ttest(3.5, 20, 20)
julia&gt; print(&quot;Bayes Factor: &quot;, round.(bf, digits=3), &quot; (two-sample independent)&quot;)
Bayes Factor: 26.743 (two-sample independent)</code></pre><ol><li>Bayes Factor of a paired two-sample T-test</li></ol><pre><code class="language-julia-repl">julia&gt; bf = Pingouin.bayesfactor_ttest(3.5, 20, 20, paired=true)
julia&gt; print(&quot;Bayes Factor: &quot;, round.(bf, digits=3), &quot; (two-sample paired)&quot;)
Bayes Factor: 17.185 (two-sample paired)</code></pre><ol><li>Bayes Factor of an one-sided one-sample T-test</li></ol><pre><code class="language-julia-repl">julia&gt; bf = Pingouin.bayesfactor_ttest(3.5, 20, tail=&quot;one-sided&quot;)
julia&gt; print(&quot;Bayes Factor: &quot;, round.(bf, digits=3), &quot; (one-sample)&quot;)
Bayes Factor: 34.369 (one-sample)</code></pre><ol><li>Now specifying the direction of the test</li></ol><pre><code class="language-julia-repl">julia&gt; tval = -3.5
julia&gt; bf_greater = Pingouin.bayesfactor_ttest(tval, 20, tail=&quot;greater&quot;)
julia&gt; bf_less = Pingouin.bayesfactor_ttest(tval, 20, tail=&quot;less&quot;)
julia&gt; print(&quot;BF10-greater: &quot;, round.(bf_greater, digits=3), &quot; | BF10-less: &quot;, round.(bf_less, digits=3))
BF10-greater: 0.029 | BF10-less: 34.369</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/clementpoiret/Pingouin.jl/blob/f0c1467bf2447643b821f24c6ff36e373cedcd60/src/bayesian.jl#L277-L364">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../effsize/">« Effect Sizes</a><a class="docs-footer-nextpage" href="../nonparametric/">Non-Parametric Tests »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Saturday 13 February 2021 19:20">Saturday 13 February 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
